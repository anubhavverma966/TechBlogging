<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Nothing here, just fragments -->
</head>
<body>
<!-- Profile Modal -->
<div th:fragment="profileModal" class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header primary-color text-white">
                <h5 class="modal-title" id="profileModalLabel">TechBlogging</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">

                <img th:src="@{'/pics/' + ${currentUser.profile}}" class="img-fluid img-profile" alt="Profile Picture">
                <h5 class="mt-3" th:text="${currentUser.name}"></h5>

                <!-- Profile Details -->
                <div id="profile-details">
                    <table class="table table-bordered">
                        <tbody>
                        <tr>
                            <th>ID</th>
                            <td th:text="${currentUser.id}"></td>
                        </tr>
                        <tr>
                            <th>Email</th>
                            <td th:text="${currentUser.email}"></td>
                        </tr>
                        <tr>
                            <th>Gender</th>
                            <td th:text="${#strings.toUpperCase(currentUser.gender)}"></td>
                        </tr>
                        <tr>
                            <th>Status</th>
                            <td th:text="${currentUser.about}"></td>
                        </tr>
                        <tr>
                            <th>Registered On</th>
                            <td th:text="${#dates.format(currentUser.dateTime, 'dd MMM yyyy HH:mm')}"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Profile Edit Form (hidden by default) -->
                <div id="profile-edit" style="display:none;">
                    <h3 class="mt-3">Edit Profile</h3>
                    <form th:object="${user}" th:action="@{/editProfile}" method="post" enctype="multipart/form-data">
                       	<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                        <table class="table">
                            <tr>
                                <td>ID:</td>
                                <td th:text="*{id}"></td>
                            </tr>
                            <tr>
                                <td>Email:</td>
                                <td><input type="email" class="form-control" th:field="*{email}"></td>
                            </tr>
                            <tr>
                                <td>Name:</td>
                                <td><input type="text" class="form-control" th:field="*{name}"></td>
                            </tr>
                            <tr>
                                <td>Password:</td>
                                <td><input type="password" class="form-control" th:field="*{password}"></td>
                            </tr>
                            <tr>
                                <td>About:</td>
                                <td><textarea rows="4" class="form-control" th:field="*{about}"></textarea></td>
                            </tr>
                            <tr>
                                <td>Profile Pic:</td>
                                <td><input type="file" name="profile_pic" class="form-control"></td>
                            </tr>
                        </table>
                        <div class="text-center">
                            <button type="submit" class="btn btn-outline-primary">Save</button>
                        </div>
                    </form>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button id="edit-profile-button" type="button" class="btn btn-primary">EDIT</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>